# Choice Sherpa - Environment Configuration Example
# Copy this file to .env and fill in your values
#
# All variables use the CHOICE_SHERPA prefix
# Nested config uses DOUBLE underscores: CHOICE_SHERPA__SERVER__PORT
# (Single underscores are preserved in field names)

# ============================================
# Server Configuration
# ============================================
CHOICE_SHERPA__SERVER__HOST=127.0.0.1
CHOICE_SHERPA__SERVER__PORT=8080
CHOICE_SHERPA__SERVER__ENVIRONMENT=development
# Options: development, staging, production

CHOICE_SHERPA__SERVER__LOG_LEVEL=info,choice_sherpa=debug,sqlx=warn
CHOICE_SHERPA__SERVER__REQUEST_TIMEOUT_SECS=30

# CORS origins (comma-separated, optional)
# CHOICE_SHERPA__SERVER__CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# ============================================
# Database Configuration (PostgreSQL)
# ============================================
CHOICE_SHERPA__DATABASE__URL=postgresql://choice-sherpa:password@localhost:5433/choice_sherpa

# Connection pool settings
CHOICE_SHERPA__DATABASE__MIN_CONNECTIONS=2
CHOICE_SHERPA__DATABASE__MAX_CONNECTIONS=10
CHOICE_SHERPA__DATABASE__ACQUIRE_TIMEOUT_SECS=30
CHOICE_SHERPA__DATABASE__IDLE_TIMEOUT_SECS=600
CHOICE_SHERPA__DATABASE__MAX_LIFETIME_SECS=1800

# Run migrations on startup (recommended for development)
CHOICE_SHERPA__DATABASE__RUN_MIGRATIONS=true

# ============================================
# Redis Configuration
# ============================================
CHOICE_SHERPA__REDIS__URL=redis://localhost:6380
CHOICE_SHERPA__REDIS__POOL_SIZE=10
CHOICE_SHERPA__REDIS__TIMEOUT_SECS=5

# ============================================
# Authentication (Zitadel OIDC)
# ============================================
# For local development, use mock auth or local Zitadel instance
CHOICE_SHERPA__AUTH__ZITADEL_AUTHORITY=https://localhost:8443
CHOICE_SHERPA__AUTH__ZITADEL_CLIENT_ID=choice-sherpa-dev
CHOICE_SHERPA__AUTH__ZITADEL_AUDIENCE=choice-sherpa-api
CHOICE_SHERPA__AUTH__JWKS_CACHE_TTL_SECS=3600

# ============================================
# AI Provider Configuration
# ============================================
# At least one provider API key is required
# Primary provider determines which one is used first

CHOICE_SHERPA__AI__PRIMARY_PROVIDER=anthropic
# Options: anthropic, openai

# Anthropic (Claude)
CHOICE_SHERPA__AI__ANTHROPIC_API_KEY=sk-ant-api03-xxx

# OpenAI (GPT-4)
CHOICE_SHERPA__AI__OPENAI_API_KEY=sk-xxx

# Optional: Fallback provider (used if primary fails)
# CHOICE_SHERPA__AI__FALLBACK_PROVIDER=openai

CHOICE_SHERPA__AI__TIMEOUT_SECS=120
CHOICE_SHERPA__AI__MAX_RETRIES=3

# ============================================
# Payment Configuration (Stripe)
# ============================================
# Use test mode keys for development (sk_test_*)
CHOICE_SHERPA__PAYMENT__STRIPE_API_KEY=sk_test_xxx
CHOICE_SHERPA__PAYMENT__STRIPE_WEBHOOK_SECRET=whsec_xxx

# Stripe Price IDs for subscription plans
# CHOICE_SHERPA__PAYMENT__STRIPE_MONTHLY_PRICE_ID=price_xxx
# CHOICE_SHERPA__PAYMENT__STRIPE_ANNUAL_PRICE_ID=price_xxx

# ============================================
# Email Configuration (Resend)
# ============================================
CHOICE_SHERPA__EMAIL__RESEND_API_KEY=re_xxx
CHOICE_SHERPA__EMAIL__FROM_EMAIL=noreply@choicesherpa.com
CHOICE_SHERPA__EMAIL__FROM_NAME=Choice Sherpa

# ============================================
# Feature Flags
# ============================================
# Enable WebSocket streaming for AI conversations
CHOICE_SHERPA__FEATURES__ENABLE_STREAMING=true

# Enable AI fallback provider on primary failure
CHOICE_SHERPA__FEATURES__ENABLE_AI_FALLBACK=true

# Show detailed error messages (disable in production!)
CHOICE_SHERPA__FEATURES__VERBOSE_ERRORS=true

# Enable request tracing
CHOICE_SHERPA__FEATURES__ENABLE_TRACING=true
